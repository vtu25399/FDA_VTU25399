import javax.servlet.*;
import javax.servlet.http.*;
import java.io.IOException;

public class TantrazServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp)
            throws IOException {

        resp.setContentType("text/html");

        resp.getWriter().println("""
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Tantraz Registration</title>
</head>

<body>

<h2>Tantraz Professional Registration</h2>

<form method="post">

<!-- Full Name -->
<label>Full Name</label><br>
<input type="text" name="fullname" aria-label="Full Name" required><br><br>

<!-- Email -->
<label>Email</label><br>
<input type="email" name="email" aria-label="Email Address" required><br><br>

<!-- Dropdown -->
<label>Participation Category</label><br>
<select name="category" aria-label="Participation Category" required>
<option value="">Select</option>
<option>Individual</option>
<option>Team</option>
<option>Audience</option>
</select><br><br>

<!-- Radio Buttons -->
<label>T-Shirt Size</label><br>
<input type="radio" name="size" value="S" required> S
<input type="radio" name="size" value="M"> M
<input type="radio" name="size" value="L"> L
<input type="radio" name="size" value="XL"> XL
<br><br>

<!-- Checkboxes -->
<label>Technical Interests</label><br>
<input type="checkbox" name="interest" value="AI"> AI
<input type="checkbox" name="interest" value="Web Dev"> Web Dev
<input type="checkbox" name="interest" value="Cloud Computing"> Cloud Computing
<br><br>

<!-- Textarea -->
<label>Expectations / Suggestions</label><br>
<textarea name="expectations" rows="4" cols="40"></textarea><br><br>

<button>Register</button>

</form>

</body>
</html>
""");
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp)
            throws IOException {

        String fullname = req.getParameter("fullname");
        String email = req.getParameter("email");
        String category = req.getParameter("category");
        String size = req.getParameter("size");
        String[] interests = req.getParameterValues("interest");
        String expectations = req.getParameter("expectations");

        StringBuilder errors = new StringBuilder();

        if (fullname == null || fullname.isEmpty())
            errors.append("Full name required<br>");

        if (email == null || !email.contains("@"))
            errors.append("Valid email required<br>");

        if (category == null || category.isEmpty())
            errors.append("Select participation category<br>");

        if (size == null)
            errors.append("Select T-shirt size<br>");

        if (interests == null || interests.length == 0)
            errors.append("Select at least one technical interest<br>");

        if (errors.length() > 0) {
            resp.getWriter().println(errors.toString());
            return;
        }

        // Successful registration
        resp.getWriter().println("""
<h3>Registration Successful!</h3>
<p>Name: %s</p>
<p>Email: %s</p>
<p>Category: %s</p>
<p>T-Shirt Size: %s</p>
<p>Expectations: %s</p>
""".formatted(fullname, email, category, size, expectations));
    }
}
